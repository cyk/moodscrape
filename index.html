<!DOCTYPE html>
<html class="no-js">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Moodscrape</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">

        <link rel="stylesheet" href="css/normalize.min.css">
        <link rel="stylesheet" href="css/main.css">
        <link href="http://fonts.googleapis.com/css?family=Open+Sans:400,700" rel="stylesheet" type="text/css">
        <link href="http://netdna.bootstrapcdn.com/font-awesome/3.1.1/css/font-awesome.css" rel="stylesheet">

        <script src="js/vendor/modernizr-2.6.2-respond-1.1.0.min.js"></script>
    </head>
    <body>

    <div id="wrapper">

      <a href="https://github.com/cyk/moodscrape"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png" alt="Fork me on GitHub"></a>

      <header>
        <h1 style="font-size:4em;">Moodscrape</h1>
      </header>

      <h2>How to Use</h2>

      <p>You can run <a href="https://github.com/cyk/moodscrape/blob/master/moodscrape.js">the script</a> from Chrome's console, or save it as a bookmarklet:</p>

      <p>
        <a class="bookmarklet" href='javascript:(function(e)%7Bvar t%3D"https%3A%2F%2Fwww.moodscope.com%2Fchart"%2Cn%3De("select%5Bname%3Dmonth%5D option")%2Cr%3D%5B%5D%2Ci%3D%5B%5D%3Bwindow.location.origin%2Bwindow.location.pathname%3D%3D%3Dt%7C%7Calert("This may not work! Expecting URL to be%3A %5Cn"%2Bt)%2Cn.each(function()%7B%2F%5E%5B0-9%5D%7B4%7D-%5B0-9%5D%7B2%7D%24%2Fi.test(this.value)%26%26r.push(this.value)%7D)%3Bvar s%3De.map(r%2Cfunction(n)%7Breturn e.get(t%2B"%3Fmonth%3D"%2Bn%2Cfunction(t)%7Be.globalEval(e(t).filter(%27script%3Acontains("chart %3D")%27)%5B0%5D.text)%2Ci%3Di.concat(chart.series%5B0%5D.data)%7D)%7D)%3Be.when.apply(null%2Cs).done(function()%7Bvar t%3D"data%3Atext%2Fcsv%3Bcharset%3Dutf-8%2C"%2Cn%3Ddocument.createElement("a")%3Be.each(i%2Cfunction()%7Bvar e%3Dthis.url.replace("%2Fchart%2Fannotate%2F"%2C"")%2Cn%3Dthis.name.replace(%2F"%2Fg%2C%27"%27).replace(%2F<br%5C%2F>%2Fg%2C" ")%3Bn%3D%3D%3D"Click to add explanation"%26%26(n%3D"")%2Ct%3Dt%2B%5Be%2Cthis.y%2C%27"%27%2Bn%2B%27"%27%5D.join("%2C")%2B"%5Cn"%7D)%2Cn.setAttribute("href"%2CencodeURI(t))%2Cn.setAttribute("download"%2C"moodscope_export.csv")%2Cn.click()%7D)%7D)(jQuery)%3B'>
          <i class="icon-bookmark"></i>
          <strong>Export Moodscope</strong>
        </a>
      </p>

      <p>To install, drag the above link to your bookmarks bar. When you run it, make sure you are logged in and your browser is on the chart page.</p>

      <h2>About</h2>

      <p>I am a fan of self-metrics and <a href="https://www.moodscope.com/">Moodscope</a> has been an invaluable tool for measuring, tracking and explaning my mood over time. Unfortunately, as far as I can tell, there is no way to export your score data for all time, though there is a way to export a particular month's mood chart. This script will iterate thru each month of tracking, collect the scores, and export to a csv.</p>

      <h2>Requirements</h2>

      <p>Aspects of the script rely on Chrome-specific features and therefore probably won't work in other browsers.</p>

      <h3>License and Disclaimer</h3>

      <p>This software is licensed under the MIT License.</p>

      <p>This project is NOT affiliated with, endorsed, or sponsored by Moodscope.</p>

    </div>

    <footer>
      <p><a href="http://cyk.im"><i class="icon-heart"></i> Cy</a></p>
    </footer>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-41755243-2', 'cyk.im');
      ga('send', 'pageview');

    </script>

    </body>
</html>
